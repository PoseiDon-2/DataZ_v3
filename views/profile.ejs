
<html lang="en">
    <%- include('./partials/head.ejs') %>
    <style>
        .bmi-container {
            width: 400px;
            padding: 20px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .bmi-container h1 {
            margin-bottom: 20px;
            color: #333;
        }
        .bmi-container input[type="number"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .bmi-container button {
            width: 100%;
            padding: 10px;
            margin: 20px 0;
            background-color: #28a745;
            border: none;
            border-radius: 5px;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
        }
        .bmi-container button:hover {
            background-color: #218838;
        }
        .bmi-result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        .bmi-status {
            margin-top: 10px;
            font-size: 16px;
            color: #007bff;
        }
    </style>
  <body>
    <h1>ออกกำลังกายสนุกจังเลย</h1>

    <%- include('./partials/nav.ejs') %>

    <div class="container">
      <div class="box">
        <h2>โปรไฟล์ของผู้ใช้</h2>
        <% if (user) { %>
            <p><strong>ชื่อ:</strong> <%= user.username %></p>
        <% } else { %>
            <p>ไม่พบข้อมูลผู้ใช้</p>
        <% } %>
      </div>

      <div class="box mt-4">
        <h2 class="text-center">ตารางการออกกำลังกาย</h2>
        <div id="calendarControls" class="d-flex justify-content-center mb-3">
          <select id="monthSelect" class="form-select w-auto me-2" onchange="updateCalendar()"></select>
          <select id="yearSelect" class="form-select w-auto" onchange="updateCalendar()"></select>
        </div>
        <div id="calendar"></div>
      </div>

      <div class="box">
        <h2>BMI</h2>
        <div class="bmi-container">
            <h1>BMI Calculator</h1>
            <input type="number" id="weight" placeholder="Enter your weight in kg" min="1">
            <input type="number" id="height" placeholder="Enter your height in cm" min="1">
            <button onclick="calculateBMI()">Calculate BMI</button>
            <div class="bmi-result" id="bmi-result"></div>
            <div class="bmi-status" id="bmi-status"></div>
        </div>
    
        
      </div>
    </div>



    <script>
        
            function calculateBMI() {
                // รับค่าน้ำหนัก (weight) และความสูง (height) จากผู้ใช้งาน
                let weight = parseFloat(document.getElementById('weight').value);
                let height = parseFloat(document.getElementById('height').value) / 100; // แปลงหน่วย cm เป็น m
    
                // ตรวจสอบค่าที่รับมาว่าไม่ว่างหรือเป็น 0
                if (weight && height) {
                    // คำนวณค่า BMI (BMI = น้ำหนัก (กก.) / (ความสูง (ม.)^2))
                    let bmi = weight / (height * height);
                    bmi = bmi.toFixed(2); // แสดงทศนิยม 2 ตำแหน่ง
    
                    // แสดงผลค่า BMI ในช่องผลลัพธ์
                    document.getElementById('bmi-result').innerText = `Your BMI: ${bmi}`;
    
                    // แสดงสถานะจากค่า BMI
                    let status = '';
                    if (bmi < 18.5) {
                        status = 'Underweight (น้ำหนักน้อยกว่ามาตรฐาน)';
                    } else if (bmi >= 18.5 && bmi < 24.9) {
                        status = 'Normal weight (น้ำหนักปกติ)';
                    } else if (bmi >= 25 && bmi < 29.9) {
                        status = 'Overweight (น้ำหนักเกินมาตรฐาน)';
                    } else {
                        status = 'Obese (โรคอ้วน)';
                    }
                    document.getElementById('bmi-status').innerText = status;
                } else {
                    // กรณีที่กรอกข้อมูลไม่ครบหรือผิดพลาด
                    document.getElementById('bmi-result').innerText = 'Please enter valid weight and height!';
                    document.getElementById('bmi-status').innerText = '';
                }
            }

      // Global variable to store the current month and year
      let currentYear = new Date().getFullYear();
      let currentMonth = new Date().getMonth();

      function generateCalendar(year, month) {
        const calendar = document.getElementById("calendar");
        calendar.innerHTML = ""; // Clear previous calendar

        // Month names in Thai
        const monthNames = [
          "มกราคม",
          "กุมภาพันธ์",
          "มีนาคม",
          "เมษายน",
          "พฤษภาคม",
          "มิถุนายน",
          "กรกฎาคม",
          "สิงหาคม",
          "กันยายน",
          "ตุลาคม",
          "พฤศจิกายน",
          "ธันวาคม",
        ];

        // Create a table for the calendar
        const table = document.createElement("table");
        table.classList.add("table", "table-bordered");

        // Add the header row for days of the week
        const headerRow = document.createElement("tr");
        const days = ["อาทิตย์", "จันทร์", "อังคาร", "พุธ", "พฤหัสบดี", "ศุกร์", "เสาร์"];
        days.forEach((day) => {
          const th = document.createElement("th");
          th.textContent = day;
          headerRow.appendChild(th);
        });
        table.appendChild(headerRow);

        // Get the first day of the month and number of days in the month
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        let currentDay = 1;
        let row;

        for (let i = 0; i < 6; i++) {
          // Create 6 rows for the calendar
          row = document.createElement("tr");

          for (let j = 0; j < 7; j++) {
            const cell = document.createElement("td");
            if (i === 0 && j < firstDay) {
              cell.textContent = ""; // Empty cells for days before the first day
            } else if (currentDay > daysInMonth) {
              cell.textContent = ""; // Empty cells after the last day
            } else {
              cell.textContent = currentDay;

              // Highlight the current day
              const today = new Date();
              if (
                currentDay === today.getDate() &&
                month === today.getMonth() &&
                year === today.getFullYear()
              ) {
                cell.classList.add("current-day");
              }

              currentDay++;
            }
            row.appendChild(cell);
          }
          table.appendChild(row);
          if (currentDay > daysInMonth) break; // Stop if we've filled all days
        }

        // Add month title
        const monthTitle = document.createElement("h3");
        monthTitle.textContent = monthNames[month] + " " + year;
        calendar.appendChild(monthTitle);
        calendar.appendChild(table);
      }

      function updateCalendar() {
        // Get selected month and year from the dropdowns
        const monthSelect = document.getElementById("monthSelect");
        const yearSelect = document.getElementById("yearSelect");

        currentMonth = parseInt(monthSelect.value);
        currentYear = parseInt(yearSelect.value);
        generateCalendar(currentYear, currentMonth);
      }

      // Populate month and year select options
      function populateDateSelectors() {
        const monthSelect = document.getElementById("monthSelect");
        const yearSelect = document.getElementById("yearSelect");

        // Add month options
        for (let i = 0; i < 12; i++) {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = i + 1; // Month number (1-12)
          monthSelect.appendChild(option);
        }

        // Add year options (last 10 years and next 10 years)
        const currentYear = new Date().getFullYear();
        for (let i = currentYear - 10; i <= currentYear + 10; i++) {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = i; // Year number
          yearSelect.appendChild(option);
        }

        // Set current month and year
        monthSelect.value = new Date().getMonth();
        yearSelect.value = currentYear;

        // Generate calendar for the current month and year
        generateCalendar(currentYear, currentMonth);
      }

      // Call function to populate date selectors
      populateDateSelectors();
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
